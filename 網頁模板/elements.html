<!DOCTYPE HTML>
<!--
	Stellar by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>çˆ¬èŸ²ç¨‹å¼ç¢¼è¬›è§£</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
<div id="wrapper">

  <!-- Header -->
  <header id="header">
    <h1>çˆ¬èŸ²ç¨‹å¼ç¢¼è¬›è§£</h1>
    <p>ä»¥ä¸‹æ˜¯ç”¨ Python å¯¦ç¾å¾®åšæ–‡å¨›ç†±æœæ¦œå‰åçˆ¬å–çš„ç¨‹å¼ç¢¼åŠè©³ç´°è§£èªªã€‚</p>
  </header>

  <!-- Main -->
<div id="main">
  <!-- Content -->
  <section id="content" class="main">
    <header class="major">
      <h2>ä½¿ç”¨ Selenium æŠ“å–å¾®åšæ–‡å¨›ç†±æœæ¦œ</h2>
      <p>ä»¥ä¸‹ä»‹ç´¹å®Œæ•´ Python çˆ¬èŸ²ç¨‹å¼ç¢¼èˆ‡å„éƒ¨åˆ†èªªæ˜</p>
    </header>

    <h3>ğŸ“Œ 1. å¥—ä»¶èˆ‡è¨­å®š</h3>
    <pre><code class="language-python"># è¼‰å…¥å¿…è¦å¥—ä»¶ï¼š
from selenium import webdriver  # è‡ªå‹•æ“ä½œç€è¦½å™¨
from selenium.webdriver.chrome.options import Options
from bs4 import BeautifulSoup   # è§£æ HTML

import time                # time - æ§åˆ¶ç­‰å¾…æ™‚é–“
import re                  # æ­£å‰‡è¡¨é”å¼è™•ç† HTML
from opencc import OpenCC  # ç°¡è½‰ç¹


</code></pre>

    <h3>ğŸ§© 2. çˆ¬èŸ²ä¸»å‡½å¼ fetch_weibo_ent_hotsearch()</h3>
    <pre><code class="language-python">def fetch_weibo_ent_hotsearch():
    options = Options()
    options.add_argument("--headless")  # ç„¡é ­æ¨¡å¼ï¼Œä¸é–‹å•Ÿç€è¦½å™¨è¦–çª—
    driver = webdriver.Chrome(options=options)  # å•Ÿå‹• Chrome
    url = "https://s.weibo.com/top/summary?cate=ent"
    driver.get(url)  # é–‹å•Ÿå¾®åšå¨›æ¨‚ç†±æœæ¦œé é¢
    time.sleep(3)    # ç­‰å¾… 3 ç§’ï¼Œç¢ºä¿é é¢è¼‰å…¥å®Œæˆ
    html = driver.page_source  # å–å¾—ç¶²é  HTML åŸå§‹ç¢¼
    driver.quit()  # é—œé–‰ç€è¦½å™¨

    soup = BeautifulSoup(html, "html.parser")  # è§£æ HTML
    rows = soup.select("table tbody tr")[:10]  # å–å‰ 10 ç­†ç†±æœè³‡æ–™

    cc = OpenCC('s2t')  # ç°¡é«”è½‰ç¹é«”è½‰æ›å™¨
    hotsearch_list = []
    for tr in rows:
        a = tr.select_one("td.td-02 a")
        if a:
            text_simplified = a.get_text(strip=True)  # å–ç°¡é«”å­—æ–‡å­—
            text_traditional = cc.convert(text_simplified)  # è½‰ç¹é«”å­—
            link = "https://s.weibo.com" + a['href']  # æ‹¼æ¥å®Œæ•´é€£çµ
            hotsearch_list.append((text_traditional, link))  # åŠ å…¥æ¸…å–®

    return hotsearch_list  # å›å‚³ç†±æœåˆ—è¡¨
</code></pre>
    <p>é€™å€‹å‡½å¼ç”¨ Selenium é–‹å‹•æ…‹ç¶²é ï¼Œç­‰ç¶²é è¼‰å…¥å¾Œç”¨ BeautifulSoup æ“·å–å‰åæ¢ç†±æœï¼Œä¸¦ç”¨ OpenCC è½‰æˆç¹é«”å­—ï¼Œæœ€å¾Œå›å‚³ (æ¨™é¡Œ, é€£çµ) çš„åˆ—è¡¨ã€‚</p>

    <h3>ğŸ“ 3. ç”Ÿæˆ HTML æ¸…å–® generate_html()</h3>
    <pre><code class="language-python">def generate_html(hotsearch_list):
    html_content = '&lt;ol style="text-align:left; padding-left:20px;"&gt;\n'  # æœ‰åºåˆ—è¡¨ï¼Œå·¦å°é½Š
    for text, link in hotsearch_list:
        html_content += f'  &lt;li&gt;&lt;a href="{link}" target="_blank"&gt;{text}&lt;/a&gt;&lt;/li&gt;\n'  # åŠ å…¥è¶…é€£çµ
    html_content += '&lt;/ol&gt;'
    return html_content  # å›å‚³çµ„åˆå¥½çš„ HTML å­—ä¸²
</code></pre>
    <p>é€™å‡½å¼æŠŠçˆ¬åˆ°çš„ç†±æœåˆ—è¡¨åšæˆæœ‰åºçš„ HTML åˆ—è¡¨ï¼Œæ–¹ä¾¿æ’å…¥ç¶²é ã€‚</p>

    <h3>ğŸ”§ 4. æ›´æ–°ç¶²é å…§å®¹ update_html_file()</h3>
    <pre><code class="language-python">def update_html_file(html_file_path, new_list_html):
    with open(html_file_path, 'r', encoding='utf-8') as f:
        content = f.read()  # è®€å–åŸå§‹ HTML

    pattern = re.compile(
        r'(&lt;div[^&gt;]+id=["\']weibo-hotsearch-list["\'][^&gt;]*&gt;)(.*?)(&lt;/div&gt;)',
        re.DOTALL
    )
    new_content = pattern.sub(r'\1' + new_list_html + r'\3', content)  # ç”¨æ–°å…§å®¹æ›¿æ›æŒ‡å®šå€å¡Š

    with open(html_file_path, 'w', encoding='utf-8') as f:
        f.write(new_content)  # å¯«å›æª”æ¡ˆ
</code></pre>
    <p>ä½¿ç”¨æ­£å‰‡æ‰¾åˆ°ç¶²é ä¸­ id="weibo-hotsearch-list" çš„å€å¡Šä¸¦æ›¿æ›æˆæ–°çˆ¬åˆ°çš„ç†±æœåˆ—è¡¨ HTMLï¼Œå®Œæˆç¶²é å…§å®¹æ›´æ–°ã€‚</p>

    <h3>ğŸš€ 5. ä¸»ç¨‹å¼åŸ·è¡Œ</h3>
    <pre><code class="language-python">if __name__ == "__main__":
    hotsearch_list = fetch_weibo_ent_hotsearch()  # æŠ“å–ç†±æœ
    if hotsearch_list:
        new_html = generate_html(hotsearch_list)  # ç”Ÿæˆ HTML
        update_html_file("index.html", new_html)  # æ›´æ–° index.html
    else:
        print("æŠ“å–å¾®åšæ–‡å¨›æ¦œå‰åå¤±æ•—")  # å¤±æ•—æç¤º
</code></pre>
    <p>æ•´å€‹çˆ¬èŸ²ç¨‹å¼å¾åŸ·è¡Œåˆ°æ›´æ–°é é¢ä¸€æ¬¡å®Œæˆï¼Œæ–¹ä¾¿è‡ªå‹•åŒ–æ›´æ–°å¾®åšç†±æœæ–‡å¨›æ¦œã€‚</p>

    <h3>ğŸ“Œ åŸ·è¡Œå‰æé†’</h3>
    <ul>
      <li>é ˆå…ˆå®‰è£ä¸¦è¨­å®šå¥½ <code>chromedriver</code>ï¼Œç‰ˆæœ¬éœ€èˆ‡ Chrome ç€è¦½å™¨åŒ¹é…ã€‚</li>
      <li>é ˆå®‰è£ç›¸é—œ Python å¥—ä»¶ï¼š
        <code>pip install selenium beautifulsoup4 opencc-python-reimplemented</code>
      </li>
      <li>ç¢ºä¿ <code>index.html</code> ä¸­æœ‰ 
        <code>&lt;div id="weibo-hotsearch-list"&gt;...&lt;/div&gt;</code> ä½œç‚ºç†±æœåˆ—è¡¨æ›¿æ›å€å¡Šã€‚
      </li>
    </ul>

  </section>
</div>




																		

				<!-- Footer -->
					<footer id="footer">
						<section>
							<h2>MBTI</h2>
							<p>ISFJ å®ˆè­·è€…ï¼ˆDefenderï¼‰<br><br>è²¬ä»»æ„Ÿå¼·ï¼šå°å·¥ä½œæŠ•å…¥ä¸”å®ˆæ™‚å®ˆä¿¡ï¼Œå€¼å¾—ä¿¡è³´ã€‚<br>

ç´°å¿ƒå‘¨åˆ°ï¼šæ“…é•·è™•ç†ç´°ç¯€ï¼Œé©åˆéœ€è¦ç²¾æº–èˆ‡è€å¿ƒçš„å·¥ä½œã€‚<br>

æ¨‚æ–¼åŠ©äººï¼šä¸»å‹•å”åŠ©åŒäº‹ï¼Œèƒ½æå‡åœ˜éšŠåˆä½œæ°£æ°›ã€‚<br>

æƒ…ç·’ç©©å®šï¼šé‡äº‹å†·éœï¼Œèƒ½ç¶­æŒè·å ´ç©©å®šèˆ‡å’Œè«§ã€‚<br>

å¿ èª å¯é ï¼šå°å…¬å¸èˆ‡ä¸»ç®¡å¿ å¿ƒï¼Œé¡˜æ„é•·æœŸæŠ•å…¥ã€‚</p>
						</section>
						<section>
							<h2>è¯çµ¡æ–¹å¼</h2>
							<dl class="alt">
								<dt>Address</dt>
								<dd>æ–°åŒ—å¸‚æ–°åº—å€xxxxxxx</dd>
								<dt>Phone</dt>
								<dd>0905xxxxxx</dd>
								<dt>Email</dt>
								<dd><a href="#">lee3887765@gmail.com</a></dd>
							</dl>
							<ul class="icons">
								<li><a href="#" class="icon brands fa-twitter alt"><span class="label">Twitter</span></a></li>
								<li><a href="#" class="icon brands fa-facebook-f alt"><span class="label">Facebook</span></a></li>
								<li><a href="#" class="icon brands fa-instagram alt"><span class="label">Instagram</span></a></li>
								<li><a href="#" class="icon brands fa-github alt"><span class="label">GitHub</span></a></li>
								<li><a href="#" class="icon brands fa-dribbble alt"><span class="label">Dribbble</span></a></li>
							</ul>
						</section>
						<p class="copyright">&copy; æç§ˆèŠï¼šç¨‹å¼ç¢¼è§£æ					</footer>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>